{% extends "base.html" %}
{% load i18n %}
{% load bootstrap4 %}

{% block title %}
    {{ event.title }}
{% endblock %}

{% block content %}
    {% with perms.event_management.change_event as can_change %}
        {% if not event.active %}
            {% if event.shifts.all %}
                {% trans "This event has not been saved! If you are done editing the event, you can save it." as not_active_error %}
                {% trans "Save" as save_trans %}
                <form method='POST' class='form' action='{% url "event_management:event_activate" event.pk %}'>
                {% csrf_token %}
                {% bootstrap_alert not_active_error|add:"<button type='submit' class='btn btn-primary'>"|add:save_trans|add:"</button>"|safe "warning" %}
                </form>
            {% else %}
                {% trans "This event has not been saved! Please add a shift to save this event." as no_shift_error %}
                {% bootstrap_alert no_shift_error "danger" %}
            {% endif %}
        {% endif %}
        <div class="page-header clearfix">
            <h1>
                {{ event.type }}: {{ event.title }} <small>({{ event.location }})</small>
            </h1>
            {% if can_change %}
                <div class="float-right">
                    <a role="button" class="btn btn-primary"
                       href="{% url "event_management:event_edit" event.pk %}">
                        <span class="fas fa-edit"></span>
                        {% trans "Edit event" %}
                    </a>
                    <a role="button" class="btn btn-danger"
                       href="{% url "event_management:event_delete" event.pk %}">
                        <span class="fas fa-trash-alt"></span>
                        {% trans "Delete event" %}
                    </a>
                </div>
            {% endif %}
        </div>
        <p>{{ event.description }}</p>
        <div>
            {% for shift in event.shifts.all %}
                {% include "event_management/fragments/shift_box_big.html" with shift=shift %}
            {% endfor %}
        </div>
        {% if can_change %}
            <a role="button" class="btn btn-secondary" href="{% url "event_management:event_createshift" event.pk %}">
                <span class="fas fa-plus"></span>
                {% trans "Add another shift" %}
            </a>
        {% endif %}
    {% endwith %}
{% endblock %}
