{% extends "base.html" %}
{% load i18n %}
{% load bootstrap %}
{% load questionnaires_extras %}

{% block title %}
    {% blocktranslate trimmed %}Answers for {{ shift }}{% endblocktranslate %}
{% endblock %}

{% block content %}
    <h1>{% blocktranslate trimmed %}Answers for {{ shift }}{% endblocktranslate %}</h1>

    {% translate "This page only shows answers of confirmed participants. You can see the answers of other participants in the disposition view." as alert %}
    {% render_alert alert "info" False %}

    {% for question in shift.questionnaire.questions.all %}
        <h2>{{ question.question_text }}</h2>

        <p>
            <em>{{ question.get_type_display }}, {{ question|required_text }}</em>
        </p>

        {% if question.type == "text" %}
            {% all_answers question shift as answers %}
            {% if answers %}
                <ul class="list-group list-group-flush">
                    {% for answer in answers %}
                        <li class="list-group-item">{{ answer }}</li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>
                    <em>{% translate "No answers so far" %}</em>
                </p>
            {% endif %}
        {% else %}
            {% aggregate_answers question shift as answer_counts %}
            {% if answer_counts %}
                <table class="table table-sm table-striped">
                    <thead>
                        <tr>
                            <th scope="col">{% translate "Answer" %}</th>
                            <th scope="col">{% translate "Count" %}</th>
                        </tr>
                    </thead>
                    <tbody>

                        {% for answer, count in answer_counts.items %}
                            <tr>
                                <td>{{ answer }}</td>
                                <td>{{ count }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p>
                    <em>{% translate "No answers so far" %}</em>
                </p>
            {% endif %}
        {% endif %}
    {% endfor %}

    <a role="button" class="btn btn-secondary mt-3" href="{{ shift.event.get_absolute_url }}">{% translate "Back to event" %}</a>
{% endblock %}
